{"version":3,"sources":["arcadegame.min.js"],"names":["r","e","n","t","o","i","f","c","require","u","a","Error","code","p","exports","call","length","1","module","Resources","Enemy","this","sprite","x","y","prototype","update","dt","render","ctx","drawImage","get","speed","console","log","Player","playerBody","undefined","playerIsActive","setPlayer","player","activePlayer","inactivePlayer","getPlayerActivity","handleInput","window","playerComponent","document","addEventListener","37","38","39","40","keyCode","allEnemies","./resources.js","2","modalActions","doc","win","canvas","createElement","getContext","main","now","Date","row","col","rowImages","clearRect","width","height","requestAnimationFrame","reset","body","appendChild","load","onReady","addPlayersToModalStart","initGame","resetGame","./startGame.js","3","closeModalStart","choosePlayer","startPlayButton","querySelectorAll","choosePlayerEl","./app.js","./engine.js","4","resourceCache","readyCallbacks","_load","url","img","Image","onload","isReady","forEach","func","src","ready","k","hasOwnProperty","urlOrArr","Array","push","5","utils","allPlayers","allKeysForPlayers","modalWindow","playerContainer","j","len","lenJ","modalPlayers","getElementById","playerContainerText","className","indexOf","toLowerCase","dataset","bodyType","textContent","toggleClass","playerData","target","./utils/utils.js","6","element","classString","nameIndex","substr"],"mappings":"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","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){\nconst Resources = require('./resources.js');\r\n\r\n// Enemies our player must avoid\r\nvar Enemy = function() {\r\n    // Variables applied to each of our instances go here,\r\n    // we've provided one for you to get started\r\n\r\n    // The image/sprite for our enemies, this uses\r\n    // a helper we've provided to easily load images\r\n    this.sprite = 'images/enemy-bug.png';\r\n    this.x = null;\r\n    this.y = null;\r\n};\r\n\r\n// Update the enemy's position, required method for game\r\n// Parameter: dt, a time delta between ticks\r\nEnemy.prototype.update = function(dt) {\r\n    // You should multiply any movement by the dt parameter\r\n    // which will ensure the game runs at the same speed for\r\n    // all computers.\r\n    this.render(dt);\r\n};\r\n\r\n// Draw the enemy on the screen, required method for game\r\nEnemy.prototype.render = function() {\r\n    ctx.drawImage(Resources.get(this.sprite), this.x, this.y);\r\n};\r\n\r\nEnemy.prototype.speed = function() {\r\n    console.log(speed);\r\n};\r\n\r\n\r\n// Now write your own player class\r\n// This class requires an update(), render() and\r\n// a handleInput() method.\r\n\r\nvar Player = function () {\r\n\tthis.playerBody = undefined;\r\n    this.playerIsActive = false;\r\n\r\n};\r\n\r\nPlayer.prototype.setPlayer = function (player) {\r\n\tthis.playerBody = player;\r\n    this.x = null;\r\n    this.y = null;\r\n    ctx.drawImage(Resources.get(this.playerBody), 101, 83);\r\n};\r\n\r\nPlayer.prototype.activePlayer = function () {\r\n    this.playerIsActive = true;\r\n};\r\n\r\nPlayer.prototype.inactivePlayer = function () {\r\n    this.playerIsActive = false;\r\n};\r\n\r\nPlayer.prototype.getPlayerActivity = function () {\r\n    return this.playerIsActive;\r\n};\r\n\r\nPlayer.prototype.handleInput = function (code) {\r\n\tconsole.log(code);\r\n};\r\n\r\nPlayer.prototype.update = function (code) {\r\n\tconsole.log(code);\r\n};\r\n\r\nvar player = new Player();\r\n\r\nwindow.playerComponent = player;\r\n// Now instantiate your objects.\r\n// Place all enemy objects in an array called allEnemies\r\n// Place the player object in a variable called player\r\n\r\nvar allEnemies = [];\r\n\r\n\r\n// This listens for key presses and sends the keys to your\r\n// Player.handleInput() method. You don't need to modify this.\r\ndocument.addEventListener('keyup', function(e) {\r\n    var allowedKeys = {\r\n        37: 'left',\r\n        38: 'up',\r\n        39: 'right',\r\n        40: 'down'\r\n    };\r\n\r\n    player.handleInput(allowedKeys[e.keyCode]);\r\n});\r\n\r\nmodule.exports = {\r\n    player: player,\r\n    allEnemies: allEnemies\r\n};\r\n\n},{\"./resources.js\":4}],2:[function(require,module,exports){\n/* Engine.js\r\n * This file provides the game loop functionality (update entities and render),\r\n * draws the initial game board on the screen, and then calls the update and\r\n * render methods on your player and enemy objects (defined in your app.js).\r\n *\r\n * A game engine works by drawing the entire game screen over and over, kind of\r\n * like a flipbook you may have created as a kid. When your player moves across\r\n * the screen, it may look like just that image/character is moving or being\r\n * drawn but that is not the case. What's really happening is the entire \"scene\"\r\n * is being drawn over and over, presenting the illusion of animation.\r\n *\r\n * This engine makes the canvas' context (ctx) object globally available to make\r\n * writing app.js a little simpler to work with.\r\n */\r\n\r\n\r\nconst Resources = require('./resources.js'),\r\n    modalActions = require('./startGame.js');\r\n\r\n/* Predefine the variables we'll be using within this scope,\r\n * create the canvas element, grab the 2D context for that canvas\r\n * set the canvas element's height/width and add it to the DOM.\r\n */\r\n\r\nvar doc = window.document,\r\n    win = window.window,\r\n    canvas = doc.createElement('canvas'),\r\n    ctx = canvas.getContext('2d'),\r\n    lastTime, allEnemies;\r\n\r\ncanvas.width = 505;\r\ncanvas.height = 606;\r\ndoc.body.appendChild(canvas);\r\n\r\n/* This function serves as the kickoff point for the game loop itself\r\n * and handles properly calling the update and render methods.\r\n */\r\nfunction main() {\r\n    /* Get our time delta information which is required if your game\r\n     * requires smooth animation. Because everyone's computer processes\r\n     * instructions at different speeds we need a constant value that\r\n     * would be the same for everyone (regardless of how fast their\r\n     * computer is) - hurray time!\r\n     */\r\n    var now = Date.now(),\r\n        dt = (now - lastTime) / 1000.0;\r\n\r\n    /* Call our update/render functions, pass along the time delta to\r\n     * our update function since it may be used for smooth animation.\r\n     */\r\n    update(dt);\r\n    render();\r\n\r\n    /* Set our lastTime variable which is used to determine the time delta\r\n     * for the next time this function is called.\r\n     */\r\n    lastTime = now;\r\n    // console.log(dt)\r\n    /* Use the browser's requestAnimationFrame function to call this\r\n     * function again as soon as the browser is able to draw another frame.\r\n     */\r\n    win.requestAnimationFrame(main);\r\n}\r\n\r\n/* This function does some initial setup that should only occur once,\r\n * particularly setting the lastTime variable that is required for the\r\n * game loop.\r\n */\r\nfunction init() {\r\n    reset();\r\n    lastTime = Date.now();\r\n    main();\r\n}\r\n\r\n/* This function is called by main (our game loop) and itself calls all\r\n * of the functions which may need to update entity's data. Based on how\r\n * you implement your collision detection (when two entities occupy the\r\n * same space, for instance when your character should die), you may find\r\n * the need to add an additional function call here. For now, we've left\r\n * it commented out - you may or may not want to implement this\r\n * functionality this way (you could just implement collision detection\r\n * on the entities themselves within your app.js file).\r\n */\r\nfunction update(dt) {\r\n    // updateEntities(dt);\r\n    // checkCollisions();\r\n}\r\n\r\n/* This is called by the update function and loops through all of the\r\n * objects within your allEnemies array as defined in app.js and calls\r\n * their update() methods. It will then call the update function for your\r\n * player object. These update methods should focus purely on updating\r\n * the data/properties related to the object. Do your drawing in your\r\n * render methods.\r\n */\r\nfunction updateEntities(dt) {\r\n    allEnemies.forEach(function(enemy) {\r\n        enemy.update(dt);\r\n    });\r\n    player.update();\r\n}\r\n\r\n/* This function initially draws the \"game level\", it will then call\r\n * the renderEntities function. Remember, this function is called every\r\n * game tick (or loop of the game engine) because that's how games work -\r\n * they are flipbooks creating the illusion of animation but in reality\r\n * they are just drawing the entire screen over and over.\r\n */\r\nfunction render() {\r\n    /* This array holds the relative URL to the image used\r\n     * for that particular row of the game level.\r\n     */\r\n    var rowImages = [\r\n            'images/water-block.png', // Top row is water\r\n            'images/stone-block.png', // Row 1 of 3 of stone\r\n            'images/stone-block.png', // Row 2 of 3 of stone\r\n            'images/stone-block.png', // Row 3 of 3 of stone\r\n            'images/grass-block.png', // Row 1 of 2 of grass\r\n            'images/grass-block.png' // Row 2 of 2 of grass\r\n        ],\r\n        numRows = 6,\r\n        numCols = 5,\r\n        row, col;\r\n\r\n    // Before drawing, clear existing canvas\r\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\r\n\r\n    /* Loop through the number of rows and columns we've defined above\r\n     * and, using the rowImages array, draw the correct image for that\r\n     * portion of the \"grid\"\r\n     */\r\n    for (row = 0; row < numRows; row++) {\r\n        for (col = 0; col < numCols; col++) {\r\n            /* The drawImage function of the canvas' context element\r\n             * requires 3 parameters: the image to draw, the x coordinate\r\n             * to start drawing and the y coordinate to start drawing.\r\n             * We're using our Resources helpers to refer to our images\r\n             * so that we get the benefits of caching these images, since\r\n             * we're using them over and over.\r\n             */\r\n             if(row === 6){\r\n                debugger;\r\n             }\r\n            ctx.drawImage(Resources.get(rowImages[row]), col * 101, row * 83);\r\n        }\r\n    }\r\n\r\n    // renderEntities();\r\n}\r\n\r\n/* This function is called by the render function and is called on each game\r\n * tick. Its purpose is to then call the render functions you have defined\r\n * on your enemy and player entities within app.js\r\n */\r\nfunction renderEntities() {\r\n    /* Loop through all of the objects within the allEnemies array and call\r\n     * the render function you have defined.\r\n     */\r\n    allEnemies.forEach(function(enemy) {\r\n        enemy.render();\r\n    });\r\n\r\n    player.render();\r\n}\r\n\r\n/* This function does nothing but it could have been a good place to\r\n * handle game reset states - maybe a new game menu or a game over screen\r\n * those sorts of things. It's only called once by the init() method.\r\n */\r\nfunction reset() {\r\n    // noop\r\n}\r\n\r\n/* Go ahead and load all of the images we know we're going to need to\r\n * draw our game level. Then set init as the callback method, so that when\r\n * all of these images are properly loaded our game will start.\r\n */\r\nResources.load([\r\n    // Map sources\r\n    'images/stone-block.png',\r\n    'images/water-block.png',\r\n    'images/grass-block.png',\r\n    // Enemy source\r\n    'images/enemy-bug.png',\r\n    // Bonuses sources\r\n    'images/Gem_Blue.png',\r\n    'images/Gem_Green.png',\r\n    'images/Gem_Orange.png',\r\n    // Player sources\r\n    'images/char-boy.png',\r\n    'images/char-cat-girl.png',\r\n    'images/char-horn-girl.png',\r\n    'images/char-pink-girl.png',\r\n    'images/char-princess-girl.png'\r\n]);\r\n// Resources.onReady(init);\r\nResources.onReady(modalActions.addPlayersToModalStart);\r\n\r\n/* Assign the canvas' context object to the global variable (the window\r\n * object when run in a browser) so that developers can use it more easily\r\n * from within their app.js files.\r\n */\r\nwindow.ctx = ctx;\r\n\r\nmodule.exports = {\r\n    initGame: init,\r\n    resetGame: reset\r\n};\n},{\"./resources.js\":4,\"./startGame.js\":5}],3:[function(require,module,exports){\nconst initGame = require('./engine.js').initGame,\r\n    closeModalStart = require('./startGame.js').closeModalStart,\r\n    choosePlayer = require('./startGame.js').choosePlayer,\r\n    player = require('./app.js').player,\r\n    init = require('./engine.js');\r\n\r\nvar startPlayButton = document.querySelectorAll('.modalStart__button')[0];\r\nchoosePlayerEl = document.querySelectorAll('#modalPlayers')[0];\r\n\r\n\r\n// This listner for choosing player body. It sets choosen image \r\n// for player and set player property playerActive to true.\r\nchoosePlayerEl.addEventListener('click', function(e) {\r\n    choosePlayer(e);\r\n    player.activePlayer();\r\n});\r\n\r\n// This listens for buton start game\r\nstartPlayButton.addEventListener('click', function(e) {\r\n    if (player.getPlayerActivity()) {\r\n        closeModalStart();\r\n        initGame();\r\n    }\r\n});\r\n\r\n// This listens for key presses and sends the keys to your\r\n// Player.handleInput() method. You don't need to modify this.\r\ndocument.addEventListener('keyup', function(e) {\r\n    var allowedKeys = {\r\n        37: 'left',\r\n        38: 'up',\r\n        39: 'right',\r\n        40: 'down'\r\n    };\r\n\r\n    player.handleInput(allowedKeys[e.keyCode]);\r\n});\n},{\"./app.js\":1,\"./engine.js\":2,\"./startGame.js\":5}],4:[function(require,module,exports){\n/* Resources.js\r\n * This is simply an image loading utility. It eases the process of loading\r\n * image files so that they can be used within your game. It also includes\r\n * a simple \"caching\" layer so it will reuse cached images if you attempt\r\n * to load the same image multiple times.\r\n */\r\nvar Resources = (function() {\r\n    var resourceCache = {};\r\n    var readyCallbacks = [];\r\n\r\n    /* This is the publicly accessible image loading function. It accepts\r\n     * an array of strings pointing to image files or a string for a single\r\n     * image. It will then call our private image loading function accordingly.\r\n     */\r\n    function load(urlOrArr) {\r\n        if(urlOrArr instanceof Array) {\r\n            /* If the developer passed in an array of images\r\n             * loop through each value and call our image\r\n             * loader on that image file\r\n             */\r\n            urlOrArr.forEach(function(url) {\r\n                _load(url);\r\n            });\r\n        } else {\r\n            /* The developer did not pass an array to this function,\r\n             * assume the value is a string and call our image loader\r\n             * directly.\r\n             */\r\n            _load(urlOrArr);\r\n        }\r\n    }\r\n\r\n    /* This is our private image loader function, it is\r\n     * called by the public image loader function.\r\n     */\r\n    function _load(url) {\r\n        if(resourceCache[url]) {\r\n            /* If this URL has been previously loaded it will exist within\r\n             * our resourceCache array. Just return that image rather than\r\n             * re-loading the image.\r\n             */\r\n            return resourceCache[url];\r\n        } else {\r\n            /* This URL has not been previously loaded and is not present\r\n             * within our cache; we'll need to load this image.\r\n             */\r\n            var img = new Image();\r\n            img.onload = function() {\r\n                /* Once our image has properly loaded, add it to our cache\r\n                 * so that we can simply return this image if the developer\r\n                 * attempts to load this file in the future.\r\n                 */\r\n                resourceCache[url] = img;\r\n\r\n                /* Once the image is actually loaded and properly cached,\r\n                 * call all of the onReady() callbacks we have defined.\r\n                 */\r\n                if(isReady()) {\r\n                    readyCallbacks.forEach(function(func) { \r\n                        func.call(); \r\n                    });\r\n                }\r\n            };\r\n\r\n            /* Set the initial cache value to false, this will change when\r\n             * the image's onload event handler is called. Finally, point\r\n             * the image's src attribute to the passed in URL.\r\n             */\r\n            resourceCache[url] = false;\r\n            img.src = url;\r\n        }\r\n    }\r\n\r\n    /* This is used by developers to grab references to images they know\r\n     * have been previously loaded. If an image is cached, this functions\r\n     * the same as calling load() on that URL.\r\n     */\r\n    function get(url) {\r\n        return resourceCache[url];\r\n    }\r\n\r\n    /* This function determines if all of the images that have been requested\r\n     * for loading have in fact been properly loaded.\r\n     */\r\n    function isReady() {\r\n        var ready = true;\r\n        for(var k in resourceCache) {\r\n            if(resourceCache.hasOwnProperty(k) &&\r\n               !resourceCache[k]) {\r\n                ready = false;\r\n            }\r\n        }\r\n        return ready;\r\n    }\r\n\r\n    /* This function will add a function to the callback stack that is called\r\n     * when all requested images are properly loaded.\r\n     */\r\n    function onReady(func) {\r\n        readyCallbacks.push(func);\r\n    }\r\n\r\n    /* This object defines the publicly accessible functions available to\r\n     * developers by creating a global Resources object.\r\n     */\r\n    return {\r\n        load: load,\r\n        get: get,\r\n        onReady: onReady,\r\n        isReady: isReady\r\n    };\r\n})();\r\n\r\nmodule.exports = Resources;\r\n\n},{}],5:[function(require,module,exports){\nconst Resources = require('./resources.js'),\r\n    utils = require('./utils/utils.js'),\r\n    player = require('./app.js').player;\r\n\r\nvar allPlayers = [\r\n        // Player sources\r\n        'images/char-boy.png',\r\n        'images/char-cat-girl.png',\r\n        'images/char-horn-girl.png',\r\n        'images/char-pink-girl.png',\r\n        'images/char-princess-girl.png'\r\n    ],\r\n    allKeysForPlayers = [\r\n        'Boy',\r\n        'Cat',\r\n        'Horn',\r\n        'Pink',\r\n        'Princess'\r\n    ],\r\n    modalWindow = document.querySelectorAll('.modalStart')[0];\r\n\r\nfunction addPlayersToModalStart() {\r\n    var modalPlayers = document.getElementById('modalPlayers'),\r\n        playerContainer, player, i, j, len, lenJ;\r\n\r\n    for (i = 0, len = allPlayers.length; i < len; i++) {\r\n        player = Resources.get(allPlayers[i]);\r\n        playerContainer = document.createElement('div');\r\n        playerContainerText = document.createElement('span');\r\n        playerContainer.className = 'playerContainer';\r\n\r\n        for (j = 0, lenJ = allKeysForPlayers.length; j < lenJ; j++) {\r\n            if (allPlayers[i].indexOf(allKeysForPlayers[j].toLowerCase()) > -1) {\r\n                player.dataset.bodyType = allKeysForPlayers[j];\r\n                playerContainerText.textContent = allKeysForPlayers[j];\r\n                playerContainer.appendChild(player);\r\n                playerContainer.appendChild(playerContainerText);\r\n            }\r\n        }\r\n\r\n        modalPlayers.appendChild(playerContainer);\r\n    }\r\n}\r\n\r\nfunction choosePlayer(e) {\r\n    var playerData = e.target.dataset,\r\n        i, len;\r\n\r\n    console.log(playerData);\r\n\r\n    for (i = 0, len = allPlayers.length; i < len; i++) {\r\n        if (allPlayers[i].indexOf(playerData.bodyType.toLowerCase()) > -1) {\r\n            console.log(Resources.get(allPlayers[i]));\r\n            player.setPlayer(Resources.get(allPlayers[i]));\r\n        }\r\n    }\r\n\r\n}\r\n\r\nfunction closeModalStart() {\r\n    utils.toggleClass(modalWindow, 'active');\r\n}\r\n\r\n\r\n\r\n// document.addEventListener('click', function(e) {\r\n// });\r\n\r\nmodule.exports = {\r\n    addPlayersToModalStart: addPlayersToModalStart,\r\n    closeModalStart: closeModalStart,\r\n    choosePlayer: choosePlayer\r\n};\n},{\"./app.js\":1,\"./resources.js\":4,\"./utils/utils.js\":6}],6:[function(require,module,exports){\n/**\r\n * @description Toggle given class using cross browser property ClassName.\r\n * @param {Object} element DOMElement to toggle class.\r\n * @param {String} className Class name that should be toggled.\r\n */\r\n// toggleClass function from https://stackoverflow.com/questions/18880890/how-do-i-toggle-an-elements-class-in-pure-javascript\r\nfunction toggleClass(element, className) {\r\n    if (!element || !className) {\r\n        return;\r\n    }\r\n\r\n    var classString = element.className,\r\n        nameIndex = classString.indexOf(className);\r\n    if (nameIndex == -1) {\r\n        classString += ' ' + className;\r\n    } else {\r\n        classString = classString.substr(0, nameIndex) + classString.substr(nameIndex + className.length);\r\n    }\r\n    element.className = classString;\r\n}\r\n\r\nmodule.exports = {\r\n    toggleClass: toggleClass\r\n};\n},{}]},{},[1,2,3,4,5,6])\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvanMvYXBwLmpzIiwic3JjL2pzL2VuZ2luZS5qcyIsInNyYy9qcy9ldmVudEhhbmRsZXIuanMiLCJzcmMvanMvcmVzb3VyY2VzLmpzIiwic3JjL2pzL3N0YXJ0R2FtZS5qcyIsInNyYy9qcy91dGlscy91dGlscy5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQ0FBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDakdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQy9NQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNwQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbEhBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3hFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbigpe2Z1bmN0aW9uIHIoZSxuLHQpe2Z1bmN0aW9uIG8oaSxmKXtpZighbltpXSl7aWYoIWVbaV0pe3ZhciBjPVwiZnVuY3Rpb25cIj09dHlwZW9mIHJlcXVpcmUmJnJlcXVpcmU7aWYoIWYmJmMpcmV0dXJuIGMoaSwhMCk7aWYodSlyZXR1cm4gdShpLCEwKTt2YXIgYT1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK2krXCInXCIpO3Rocm93IGEuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixhfXZhciBwPW5baV09e2V4cG9ydHM6e319O2VbaV1bMF0uY2FsbChwLmV4cG9ydHMsZnVuY3Rpb24ocil7dmFyIG49ZVtpXVsxXVtyXTtyZXR1cm4gbyhufHxyKX0scCxwLmV4cG9ydHMscixlLG4sdCl9cmV0dXJuIG5baV0uZXhwb3J0c31mb3IodmFyIHU9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZSxpPTA7aTx0Lmxlbmd0aDtpKyspbyh0W2ldKTtyZXR1cm4gb31yZXR1cm4gcn0pKCkiLCJjb25zdCBSZXNvdXJjZXMgPSByZXF1aXJlKCcuL3Jlc291cmNlcy5qcycpO1xyXG5cclxuLy8gRW5lbWllcyBvdXIgcGxheWVyIG11c3QgYXZvaWRcclxudmFyIEVuZW15ID0gZnVuY3Rpb24oKSB7XHJcbiAgICAvLyBWYXJpYWJsZXMgYXBwbGllZCB0byBlYWNoIG9mIG91ciBpbnN0YW5jZXMgZ28gaGVyZSxcclxuICAgIC8vIHdlJ3ZlIHByb3ZpZGVkIG9uZSBmb3IgeW91IHRvIGdldCBzdGFydGVkXHJcblxyXG4gICAgLy8gVGhlIGltYWdlL3Nwcml0ZSBmb3Igb3VyIGVuZW1pZXMsIHRoaXMgdXNlc1xyXG4gICAgLy8gYSBoZWxwZXIgd2UndmUgcHJvdmlkZWQgdG8gZWFzaWx5IGxvYWQgaW1hZ2VzXHJcbiAgICB0aGlzLnNwcml0ZSA9ICdpbWFnZXMvZW5lbXktYnVnLnBuZyc7XHJcbiAgICB0aGlzLnggPSBudWxsO1xyXG4gICAgdGhpcy55ID0gbnVsbDtcclxufTtcclxuXHJcbi8vIFVwZGF0ZSB0aGUgZW5lbXkncyBwb3NpdGlvbiwgcmVxdWlyZWQgbWV0aG9kIGZvciBnYW1lXHJcbi8vIFBhcmFtZXRlcjogZHQsIGEgdGltZSBkZWx0YSBiZXR3ZWVuIHRpY2tzXHJcbkVuZW15LnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbihkdCkge1xyXG4gICAgLy8gWW91IHNob3VsZCBtdWx0aXBseSBhbnkgbW92ZW1lbnQgYnkgdGhlIGR0IHBhcmFtZXRlclxyXG4gICAgLy8gd2hpY2ggd2lsbCBlbnN1cmUgdGhlIGdhbWUgcnVucyBhdCB0aGUgc2FtZSBzcGVlZCBmb3JcclxuICAgIC8vIGFsbCBjb21wdXRlcnMuXHJcbiAgICB0aGlzLnJlbmRlcihkdCk7XHJcbn07XHJcblxyXG4vLyBEcmF3IHRoZSBlbmVteSBvbiB0aGUgc2NyZWVuLCByZXF1aXJlZCBtZXRob2QgZm9yIGdhbWVcclxuRW5lbXkucHJvdG90eXBlLnJlbmRlciA9IGZ1bmN0aW9uKCkge1xyXG4gICAgY3R4LmRyYXdJbWFnZShSZXNvdXJjZXMuZ2V0KHRoaXMuc3ByaXRlKSwgdGhpcy54LCB0aGlzLnkpO1xyXG59O1xyXG5cclxuRW5lbXkucHJvdG90eXBlLnNwZWVkID0gZnVuY3Rpb24oKSB7XHJcbiAgICBjb25zb2xlLmxvZyhzcGVlZCk7XHJcbn07XHJcblxyXG5cclxuLy8gTm93IHdyaXRlIHlvdXIgb3duIHBsYXllciBjbGFzc1xyXG4vLyBUaGlzIGNsYXNzIHJlcXVpcmVzIGFuIHVwZGF0ZSgpLCByZW5kZXIoKSBhbmRcclxuLy8gYSBoYW5kbGVJbnB1dCgpIG1ldGhvZC5cclxuXHJcbnZhciBQbGF5ZXIgPSBmdW5jdGlvbiAoKSB7XHJcblx0dGhpcy5wbGF5ZXJCb2R5ID0gdW5kZWZpbmVkO1xyXG4gICAgdGhpcy5wbGF5ZXJJc0FjdGl2ZSA9IGZhbHNlO1xyXG5cclxufTtcclxuXHJcblBsYXllci5wcm90b3R5cGUuc2V0UGxheWVyID0gZnVuY3Rpb24gKHBsYXllcikge1xyXG5cdHRoaXMucGxheWVyQm9keSA9IHBsYXllcjtcclxuICAgIHRoaXMueCA9IG51bGw7XHJcbiAgICB0aGlzLnkgPSBudWxsO1xyXG4gICAgY3R4LmRyYXdJbWFnZShSZXNvdXJjZXMuZ2V0KHRoaXMucGxheWVyQm9keSksIDEwMSwgODMpO1xyXG59O1xyXG5cclxuUGxheWVyLnByb3RvdHlwZS5hY3RpdmVQbGF5ZXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICB0aGlzLnBsYXllcklzQWN0aXZlID0gdHJ1ZTtcclxufTtcclxuXHJcblBsYXllci5wcm90b3R5cGUuaW5hY3RpdmVQbGF5ZXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICB0aGlzLnBsYXllcklzQWN0aXZlID0gZmFsc2U7XHJcbn07XHJcblxyXG5QbGF5ZXIucHJvdG90eXBlLmdldFBsYXllckFjdGl2aXR5ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgcmV0dXJuIHRoaXMucGxheWVySXNBY3RpdmU7XHJcbn07XHJcblxyXG5QbGF5ZXIucHJvdG90eXBlLmhhbmRsZUlucHV0ID0gZnVuY3Rpb24gKGNvZGUpIHtcclxuXHRjb25zb2xlLmxvZyhjb2RlKTtcclxufTtcclxuXHJcblBsYXllci5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24gKGNvZGUpIHtcclxuXHRjb25zb2xlLmxvZyhjb2RlKTtcclxufTtcclxuXHJcbnZhciBwbGF5ZXIgPSBuZXcgUGxheWVyKCk7XHJcblxyXG53aW5kb3cucGxheWVyQ29tcG9uZW50ID0gcGxheWVyO1xyXG4vLyBOb3cgaW5zdGFudGlhdGUgeW91ciBvYmplY3RzLlxyXG4vLyBQbGFjZSBhbGwgZW5lbXkgb2JqZWN0cyBpbiBhbiBhcnJheSBjYWxsZWQgYWxsRW5lbWllc1xyXG4vLyBQbGFjZSB0aGUgcGxheWVyIG9iamVjdCBpbiBhIHZhcmlhYmxlIGNhbGxlZCBwbGF5ZXJcclxuXHJcbnZhciBhbGxFbmVtaWVzID0gW107XHJcblxyXG5cclxuLy8gVGhpcyBsaXN0ZW5zIGZvciBrZXkgcHJlc3NlcyBhbmQgc2VuZHMgdGhlIGtleXMgdG8geW91clxyXG4vLyBQbGF5ZXIuaGFuZGxlSW5wdXQoKSBtZXRob2QuIFlvdSBkb24ndCBuZWVkIHRvIG1vZGlmeSB0aGlzLlxyXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXl1cCcsIGZ1bmN0aW9uKGUpIHtcclxuICAgIHZhciBhbGxvd2VkS2V5cyA9IHtcclxuICAgICAgICAzNzogJ2xlZnQnLFxyXG4gICAgICAgIDM4OiAndXAnLFxyXG4gICAgICAgIDM5OiAncmlnaHQnLFxyXG4gICAgICAgIDQwOiAnZG93bidcclxuICAgIH07XHJcblxyXG4gICAgcGxheWVyLmhhbmRsZUlucHV0KGFsbG93ZWRLZXlzW2Uua2V5Q29kZV0pO1xyXG59KTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0ge1xyXG4gICAgcGxheWVyOiBwbGF5ZXIsXHJcbiAgICBhbGxFbmVtaWVzOiBhbGxFbmVtaWVzXHJcbn07XHJcbiIsIi8qIEVuZ2luZS5qc1xyXG4gKiBUaGlzIGZpbGUgcHJvdmlkZXMgdGhlIGdhbWUgbG9vcCBmdW5jdGlvbmFsaXR5ICh1cGRhdGUgZW50aXRpZXMgYW5kIHJlbmRlciksXHJcbiAqIGRyYXdzIHRoZSBpbml0aWFsIGdhbWUgYm9hcmQgb24gdGhlIHNjcmVlbiwgYW5kIHRoZW4gY2FsbHMgdGhlIHVwZGF0ZSBhbmRcclxuICogcmVuZGVyIG1ldGhvZHMgb24geW91ciBwbGF5ZXIgYW5kIGVuZW15IG9iamVjdHMgKGRlZmluZWQgaW4geW91ciBhcHAuanMpLlxyXG4gKlxyXG4gKiBBIGdhbWUgZW5naW5lIHdvcmtzIGJ5IGRyYXdpbmcgdGhlIGVudGlyZSBnYW1lIHNjcmVlbiBvdmVyIGFuZCBvdmVyLCBraW5kIG9mXHJcbiAqIGxpa2UgYSBmbGlwYm9vayB5b3UgbWF5IGhhdmUgY3JlYXRlZCBhcyBhIGtpZC4gV2hlbiB5b3VyIHBsYXllciBtb3ZlcyBhY3Jvc3NcclxuICogdGhlIHNjcmVlbiwgaXQgbWF5IGxvb2sgbGlrZSBqdXN0IHRoYXQgaW1hZ2UvY2hhcmFjdGVyIGlzIG1vdmluZyBvciBiZWluZ1xyXG4gKiBkcmF3biBidXQgdGhhdCBpcyBub3QgdGhlIGNhc2UuIFdoYXQncyByZWFsbHkgaGFwcGVuaW5nIGlzIHRoZSBlbnRpcmUgXCJzY2VuZVwiXHJcbiAqIGlzIGJlaW5nIGRyYXduIG92ZXIgYW5kIG92ZXIsIHByZXNlbnRpbmcgdGhlIGlsbHVzaW9uIG9mIGFuaW1hdGlvbi5cclxuICpcclxuICogVGhpcyBlbmdpbmUgbWFrZXMgdGhlIGNhbnZhcycgY29udGV4dCAoY3R4KSBvYmplY3QgZ2xvYmFsbHkgYXZhaWxhYmxlIHRvIG1ha2VcclxuICogd3JpdGluZyBhcHAuanMgYSBsaXR0bGUgc2ltcGxlciB0byB3b3JrIHdpdGguXHJcbiAqL1xyXG5cclxuXHJcbmNvbnN0IFJlc291cmNlcyA9IHJlcXVpcmUoJy4vcmVzb3VyY2VzLmpzJyksXHJcbiAgICBtb2RhbEFjdGlvbnMgPSByZXF1aXJlKCcuL3N0YXJ0R2FtZS5qcycpO1xyXG5cclxuLyogUHJlZGVmaW5lIHRoZSB2YXJpYWJsZXMgd2UnbGwgYmUgdXNpbmcgd2l0aGluIHRoaXMgc2NvcGUsXHJcbiAqIGNyZWF0ZSB0aGUgY2FudmFzIGVsZW1lbnQsIGdyYWIgdGhlIDJEIGNvbnRleHQgZm9yIHRoYXQgY2FudmFzXHJcbiAqIHNldCB0aGUgY2FudmFzIGVsZW1lbnQncyBoZWlnaHQvd2lkdGggYW5kIGFkZCBpdCB0byB0aGUgRE9NLlxyXG4gKi9cclxuXHJcbnZhciBkb2MgPSB3aW5kb3cuZG9jdW1lbnQsXHJcbiAgICB3aW4gPSB3aW5kb3cud2luZG93LFxyXG4gICAgY2FudmFzID0gZG9jLmNyZWF0ZUVsZW1lbnQoJ2NhbnZhcycpLFxyXG4gICAgY3R4ID0gY2FudmFzLmdldENvbnRleHQoJzJkJyksXHJcbiAgICBsYXN0VGltZSwgYWxsRW5lbWllcztcclxuXHJcbmNhbnZhcy53aWR0aCA9IDUwNTtcclxuY2FudmFzLmhlaWdodCA9IDYwNjtcclxuZG9jLmJvZHkuYXBwZW5kQ2hpbGQoY2FudmFzKTtcclxuXHJcbi8qIFRoaXMgZnVuY3Rpb24gc2VydmVzIGFzIHRoZSBraWNrb2ZmIHBvaW50IGZvciB0aGUgZ2FtZSBsb29wIGl0c2VsZlxyXG4gKiBhbmQgaGFuZGxlcyBwcm9wZXJseSBjYWxsaW5nIHRoZSB1cGRhdGUgYW5kIHJlbmRlciBtZXRob2RzLlxyXG4gKi9cclxuZnVuY3Rpb24gbWFpbigpIHtcclxuICAgIC8qIEdldCBvdXIgdGltZSBkZWx0YSBpbmZvcm1hdGlvbiB3aGljaCBpcyByZXF1aXJlZCBpZiB5b3VyIGdhbWVcclxuICAgICAqIHJlcXVpcmVzIHNtb290aCBhbmltYXRpb24uIEJlY2F1c2UgZXZlcnlvbmUncyBjb21wdXRlciBwcm9jZXNzZXNcclxuICAgICAqIGluc3RydWN0aW9ucyBhdCBkaWZmZXJlbnQgc3BlZWRzIHdlIG5lZWQgYSBjb25zdGFudCB2YWx1ZSB0aGF0XHJcbiAgICAgKiB3b3VsZCBiZSB0aGUgc2FtZSBmb3IgZXZlcnlvbmUgKHJlZ2FyZGxlc3Mgb2YgaG93IGZhc3QgdGhlaXJcclxuICAgICAqIGNvbXB1dGVyIGlzKSAtIGh1cnJheSB0aW1lIVxyXG4gICAgICovXHJcbiAgICB2YXIgbm93ID0gRGF0ZS5ub3coKSxcclxuICAgICAgICBkdCA9IChub3cgLSBsYXN0VGltZSkgLyAxMDAwLjA7XHJcblxyXG4gICAgLyogQ2FsbCBvdXIgdXBkYXRlL3JlbmRlciBmdW5jdGlvbnMsIHBhc3MgYWxvbmcgdGhlIHRpbWUgZGVsdGEgdG9cclxuICAgICAqIG91ciB1cGRhdGUgZnVuY3Rpb24gc2luY2UgaXQgbWF5IGJlIHVzZWQgZm9yIHNtb290aCBhbmltYXRpb24uXHJcbiAgICAgKi9cclxuICAgIHVwZGF0ZShkdCk7XHJcbiAgICByZW5kZXIoKTtcclxuXHJcbiAgICAvKiBTZXQgb3VyIGxhc3RUaW1lIHZhcmlhYmxlIHdoaWNoIGlzIHVzZWQgdG8gZGV0ZXJtaW5lIHRoZSB0aW1lIGRlbHRhXHJcbiAgICAgKiBmb3IgdGhlIG5leHQgdGltZSB0aGlzIGZ1bmN0aW9uIGlzIGNhbGxlZC5cclxuICAgICAqL1xyXG4gICAgbGFzdFRpbWUgPSBub3c7XHJcbiAgICAvLyBjb25zb2xlLmxvZyhkdClcclxuICAgIC8qIFVzZSB0aGUgYnJvd3NlcidzIHJlcXVlc3RBbmltYXRpb25GcmFtZSBmdW5jdGlvbiB0byBjYWxsIHRoaXNcclxuICAgICAqIGZ1bmN0aW9uIGFnYWluIGFzIHNvb24gYXMgdGhlIGJyb3dzZXIgaXMgYWJsZSB0byBkcmF3IGFub3RoZXIgZnJhbWUuXHJcbiAgICAgKi9cclxuICAgIHdpbi5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUobWFpbik7XHJcbn1cclxuXHJcbi8qIFRoaXMgZnVuY3Rpb24gZG9lcyBzb21lIGluaXRpYWwgc2V0dXAgdGhhdCBzaG91bGQgb25seSBvY2N1ciBvbmNlLFxyXG4gKiBwYXJ0aWN1bGFybHkgc2V0dGluZyB0aGUgbGFzdFRpbWUgdmFyaWFibGUgdGhhdCBpcyByZXF1aXJlZCBmb3IgdGhlXHJcbiAqIGdhbWUgbG9vcC5cclxuICovXHJcbmZ1bmN0aW9uIGluaXQoKSB7XHJcbiAgICByZXNldCgpO1xyXG4gICAgbGFzdFRpbWUgPSBEYXRlLm5vdygpO1xyXG4gICAgbWFpbigpO1xyXG59XHJcblxyXG4vKiBUaGlzIGZ1bmN0aW9uIGlzIGNhbGxlZCBieSBtYWluIChvdXIgZ2FtZSBsb29wKSBhbmQgaXRzZWxmIGNhbGxzIGFsbFxyXG4gKiBvZiB0aGUgZnVuY3Rpb25zIHdoaWNoIG1heSBuZWVkIHRvIHVwZGF0ZSBlbnRpdHkncyBkYXRhLiBCYXNlZCBvbiBob3dcclxuICogeW91IGltcGxlbWVudCB5b3VyIGNvbGxpc2lvbiBkZXRlY3Rpb24gKHdoZW4gdHdvIGVudGl0aWVzIG9jY3VweSB0aGVcclxuICogc2FtZSBzcGFjZSwgZm9yIGluc3RhbmNlIHdoZW4geW91ciBjaGFyYWN0ZXIgc2hvdWxkIGRpZSksIHlvdSBtYXkgZmluZFxyXG4gKiB0aGUgbmVlZCB0byBhZGQgYW4gYWRkaXRpb25hbCBmdW5jdGlvbiBjYWxsIGhlcmUuIEZvciBub3csIHdlJ3ZlIGxlZnRcclxuICogaXQgY29tbWVudGVkIG91dCAtIHlvdSBtYXkgb3IgbWF5IG5vdCB3YW50IHRvIGltcGxlbWVudCB0aGlzXHJcbiAqIGZ1bmN0aW9uYWxpdHkgdGhpcyB3YXkgKHlvdSBjb3VsZCBqdXN0IGltcGxlbWVudCBjb2xsaXNpb24gZGV0ZWN0aW9uXHJcbiAqIG9uIHRoZSBlbnRpdGllcyB0aGVtc2VsdmVzIHdpdGhpbiB5b3VyIGFwcC5qcyBmaWxlKS5cclxuICovXHJcbmZ1bmN0aW9uIHVwZGF0ZShkdCkge1xyXG4gICAgLy8gdXBkYXRlRW50aXRpZXMoZHQpO1xyXG4gICAgLy8gY2hlY2tDb2xsaXNpb25zKCk7XHJcbn1cclxuXHJcbi8qIFRoaXMgaXMgY2FsbGVkIGJ5IHRoZSB1cGRhdGUgZnVuY3Rpb24gYW5kIGxvb3BzIHRocm91Z2ggYWxsIG9mIHRoZVxyXG4gKiBvYmplY3RzIHdpdGhpbiB5b3VyIGFsbEVuZW1pZXMgYXJyYXkgYXMgZGVmaW5lZCBpbiBhcHAuanMgYW5kIGNhbGxzXHJcbiAqIHRoZWlyIHVwZGF0ZSgpIG1ldGhvZHMuIEl0IHdpbGwgdGhlbiBjYWxsIHRoZSB1cGRhdGUgZnVuY3Rpb24gZm9yIHlvdXJcclxuICogcGxheWVyIG9iamVjdC4gVGhlc2UgdXBkYXRlIG1ldGhvZHMgc2hvdWxkIGZvY3VzIHB1cmVseSBvbiB1cGRhdGluZ1xyXG4gKiB0aGUgZGF0YS9wcm9wZXJ0aWVzIHJlbGF0ZWQgdG8gdGhlIG9iamVjdC4gRG8geW91ciBkcmF3aW5nIGluIHlvdXJcclxuICogcmVuZGVyIG1ldGhvZHMuXHJcbiAqL1xyXG5mdW5jdGlvbiB1cGRhdGVFbnRpdGllcyhkdCkge1xyXG4gICAgYWxsRW5lbWllcy5mb3JFYWNoKGZ1bmN0aW9uKGVuZW15KSB7XHJcbiAgICAgICAgZW5lbXkudXBkYXRlKGR0KTtcclxuICAgIH0pO1xyXG4gICAgcGxheWVyLnVwZGF0ZSgpO1xyXG59XHJcblxyXG4vKiBUaGlzIGZ1bmN0aW9uIGluaXRpYWxseSBkcmF3cyB0aGUgXCJnYW1lIGxldmVsXCIsIGl0IHdpbGwgdGhlbiBjYWxsXHJcbiAqIHRoZSByZW5kZXJFbnRpdGllcyBmdW5jdGlvbi4gUmVtZW1iZXIsIHRoaXMgZnVuY3Rpb24gaXMgY2FsbGVkIGV2ZXJ5XHJcbiAqIGdhbWUgdGljayAob3IgbG9vcCBvZiB0aGUgZ2FtZSBlbmdpbmUpIGJlY2F1c2UgdGhhdCdzIGhvdyBnYW1lcyB3b3JrIC1cclxuICogdGhleSBhcmUgZmxpcGJvb2tzIGNyZWF0aW5nIHRoZSBpbGx1c2lvbiBvZiBhbmltYXRpb24gYnV0IGluIHJlYWxpdHlcclxuICogdGhleSBhcmUganVzdCBkcmF3aW5nIHRoZSBlbnRpcmUgc2NyZWVuIG92ZXIgYW5kIG92ZXIuXHJcbiAqL1xyXG5mdW5jdGlvbiByZW5kZXIoKSB7XHJcbiAgICAvKiBUaGlzIGFycmF5IGhvbGRzIHRoZSByZWxhdGl2ZSBVUkwgdG8gdGhlIGltYWdlIHVzZWRcclxuICAgICAqIGZvciB0aGF0IHBhcnRpY3VsYXIgcm93IG9mIHRoZSBnYW1lIGxldmVsLlxyXG4gICAgICovXHJcbiAgICB2YXIgcm93SW1hZ2VzID0gW1xyXG4gICAgICAgICAgICAnaW1hZ2VzL3dhdGVyLWJsb2NrLnBuZycsIC8vIFRvcCByb3cgaXMgd2F0ZXJcclxuICAgICAgICAgICAgJ2ltYWdlcy9zdG9uZS1ibG9jay5wbmcnLCAvLyBSb3cgMSBvZiAzIG9mIHN0b25lXHJcbiAgICAgICAgICAgICdpbWFnZXMvc3RvbmUtYmxvY2sucG5nJywgLy8gUm93IDIgb2YgMyBvZiBzdG9uZVxyXG4gICAgICAgICAgICAnaW1hZ2VzL3N0b25lLWJsb2NrLnBuZycsIC8vIFJvdyAzIG9mIDMgb2Ygc3RvbmVcclxuICAgICAgICAgICAgJ2ltYWdlcy9ncmFzcy1ibG9jay5wbmcnLCAvLyBSb3cgMSBvZiAyIG9mIGdyYXNzXHJcbiAgICAgICAgICAgICdpbWFnZXMvZ3Jhc3MtYmxvY2sucG5nJyAvLyBSb3cgMiBvZiAyIG9mIGdyYXNzXHJcbiAgICAgICAgXSxcclxuICAgICAgICBudW1Sb3dzID0gNixcclxuICAgICAgICBudW1Db2xzID0gNSxcclxuICAgICAgICByb3csIGNvbDtcclxuXHJcbiAgICAvLyBCZWZvcmUgZHJhd2luZywgY2xlYXIgZXhpc3RpbmcgY2FudmFzXHJcbiAgICBjdHguY2xlYXJSZWN0KDAsIDAsIGNhbnZhcy53aWR0aCwgY2FudmFzLmhlaWdodCk7XHJcblxyXG4gICAgLyogTG9vcCB0aHJvdWdoIHRoZSBudW1iZXIgb2Ygcm93cyBhbmQgY29sdW1ucyB3ZSd2ZSBkZWZpbmVkIGFib3ZlXHJcbiAgICAgKiBhbmQsIHVzaW5nIHRoZSByb3dJbWFnZXMgYXJyYXksIGRyYXcgdGhlIGNvcnJlY3QgaW1hZ2UgZm9yIHRoYXRcclxuICAgICAqIHBvcnRpb24gb2YgdGhlIFwiZ3JpZFwiXHJcbiAgICAgKi9cclxuICAgIGZvciAocm93ID0gMDsgcm93IDwgbnVtUm93czsgcm93KyspIHtcclxuICAgICAgICBmb3IgKGNvbCA9IDA7IGNvbCA8IG51bUNvbHM7IGNvbCsrKSB7XHJcbiAgICAgICAgICAgIC8qIFRoZSBkcmF3SW1hZ2UgZnVuY3Rpb24gb2YgdGhlIGNhbnZhcycgY29udGV4dCBlbGVtZW50XHJcbiAgICAgICAgICAgICAqIHJlcXVpcmVzIDMgcGFyYW1ldGVyczogdGhlIGltYWdlIHRvIGRyYXcsIHRoZSB4IGNvb3JkaW5hdGVcclxuICAgICAgICAgICAgICogdG8gc3RhcnQgZHJhd2luZyBhbmQgdGhlIHkgY29vcmRpbmF0ZSB0byBzdGFydCBkcmF3aW5nLlxyXG4gICAgICAgICAgICAgKiBXZSdyZSB1c2luZyBvdXIgUmVzb3VyY2VzIGhlbHBlcnMgdG8gcmVmZXIgdG8gb3VyIGltYWdlc1xyXG4gICAgICAgICAgICAgKiBzbyB0aGF0IHdlIGdldCB0aGUgYmVuZWZpdHMgb2YgY2FjaGluZyB0aGVzZSBpbWFnZXMsIHNpbmNlXHJcbiAgICAgICAgICAgICAqIHdlJ3JlIHVzaW5nIHRoZW0gb3ZlciBhbmQgb3Zlci5cclxuICAgICAgICAgICAgICovXHJcbiAgICAgICAgICAgICBpZihyb3cgPT09IDYpe1xyXG4gICAgICAgICAgICAgICAgZGVidWdnZXI7XHJcbiAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGN0eC5kcmF3SW1hZ2UoUmVzb3VyY2VzLmdldChyb3dJbWFnZXNbcm93XSksIGNvbCAqIDEwMSwgcm93ICogODMpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyByZW5kZXJFbnRpdGllcygpO1xyXG59XHJcblxyXG4vKiBUaGlzIGZ1bmN0aW9uIGlzIGNhbGxlZCBieSB0aGUgcmVuZGVyIGZ1bmN0aW9uIGFuZCBpcyBjYWxsZWQgb24gZWFjaCBnYW1lXHJcbiAqIHRpY2suIEl0cyBwdXJwb3NlIGlzIHRvIHRoZW4gY2FsbCB0aGUgcmVuZGVyIGZ1bmN0aW9ucyB5b3UgaGF2ZSBkZWZpbmVkXHJcbiAqIG9uIHlvdXIgZW5lbXkgYW5kIHBsYXllciBlbnRpdGllcyB3aXRoaW4gYXBwLmpzXHJcbiAqL1xyXG5mdW5jdGlvbiByZW5kZXJFbnRpdGllcygpIHtcclxuICAgIC8qIExvb3AgdGhyb3VnaCBhbGwgb2YgdGhlIG9iamVjdHMgd2l0aGluIHRoZSBhbGxFbmVtaWVzIGFycmF5IGFuZCBjYWxsXHJcbiAgICAgKiB0aGUgcmVuZGVyIGZ1bmN0aW9uIHlvdSBoYXZlIGRlZmluZWQuXHJcbiAgICAgKi9cclxuICAgIGFsbEVuZW1pZXMuZm9yRWFjaChmdW5jdGlvbihlbmVteSkge1xyXG4gICAgICAgIGVuZW15LnJlbmRlcigpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgcGxheWVyLnJlbmRlcigpO1xyXG59XHJcblxyXG4vKiBUaGlzIGZ1bmN0aW9uIGRvZXMgbm90aGluZyBidXQgaXQgY291bGQgaGF2ZSBiZWVuIGEgZ29vZCBwbGFjZSB0b1xyXG4gKiBoYW5kbGUgZ2FtZSByZXNldCBzdGF0ZXMgLSBtYXliZSBhIG5ldyBnYW1lIG1lbnUgb3IgYSBnYW1lIG92ZXIgc2NyZWVuXHJcbiAqIHRob3NlIHNvcnRzIG9mIHRoaW5ncy4gSXQncyBvbmx5IGNhbGxlZCBvbmNlIGJ5IHRoZSBpbml0KCkgbWV0aG9kLlxyXG4gKi9cclxuZnVuY3Rpb24gcmVzZXQoKSB7XHJcbiAgICAvLyBub29wXHJcbn1cclxuXHJcbi8qIEdvIGFoZWFkIGFuZCBsb2FkIGFsbCBvZiB0aGUgaW1hZ2VzIHdlIGtub3cgd2UncmUgZ29pbmcgdG8gbmVlZCB0b1xyXG4gKiBkcmF3IG91ciBnYW1lIGxldmVsLiBUaGVuIHNldCBpbml0IGFzIHRoZSBjYWxsYmFjayBtZXRob2QsIHNvIHRoYXQgd2hlblxyXG4gKiBhbGwgb2YgdGhlc2UgaW1hZ2VzIGFyZSBwcm9wZXJseSBsb2FkZWQgb3VyIGdhbWUgd2lsbCBzdGFydC5cclxuICovXHJcblJlc291cmNlcy5sb2FkKFtcclxuICAgIC8vIE1hcCBzb3VyY2VzXHJcbiAgICAnaW1hZ2VzL3N0b25lLWJsb2NrLnBuZycsXHJcbiAgICAnaW1hZ2VzL3dhdGVyLWJsb2NrLnBuZycsXHJcbiAgICAnaW1hZ2VzL2dyYXNzLWJsb2NrLnBuZycsXHJcbiAgICAvLyBFbmVteSBzb3VyY2VcclxuICAgICdpbWFnZXMvZW5lbXktYnVnLnBuZycsXHJcbiAgICAvLyBCb251c2VzIHNvdXJjZXNcclxuICAgICdpbWFnZXMvR2VtX0JsdWUucG5nJyxcclxuICAgICdpbWFnZXMvR2VtX0dyZWVuLnBuZycsXHJcbiAgICAnaW1hZ2VzL0dlbV9PcmFuZ2UucG5nJyxcclxuICAgIC8vIFBsYXllciBzb3VyY2VzXHJcbiAgICAnaW1hZ2VzL2NoYXItYm95LnBuZycsXHJcbiAgICAnaW1hZ2VzL2NoYXItY2F0LWdpcmwucG5nJyxcclxuICAgICdpbWFnZXMvY2hhci1ob3JuLWdpcmwucG5nJyxcclxuICAgICdpbWFnZXMvY2hhci1waW5rLWdpcmwucG5nJyxcclxuICAgICdpbWFnZXMvY2hhci1wcmluY2Vzcy1naXJsLnBuZydcclxuXSk7XHJcbi8vIFJlc291cmNlcy5vblJlYWR5KGluaXQpO1xyXG5SZXNvdXJjZXMub25SZWFkeShtb2RhbEFjdGlvbnMuYWRkUGxheWVyc1RvTW9kYWxTdGFydCk7XHJcblxyXG4vKiBBc3NpZ24gdGhlIGNhbnZhcycgY29udGV4dCBvYmplY3QgdG8gdGhlIGdsb2JhbCB2YXJpYWJsZSAodGhlIHdpbmRvd1xyXG4gKiBvYmplY3Qgd2hlbiBydW4gaW4gYSBicm93c2VyKSBzbyB0aGF0IGRldmVsb3BlcnMgY2FuIHVzZSBpdCBtb3JlIGVhc2lseVxyXG4gKiBmcm9tIHdpdGhpbiB0aGVpciBhcHAuanMgZmlsZXMuXHJcbiAqL1xyXG53aW5kb3cuY3R4ID0gY3R4O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSB7XHJcbiAgICBpbml0R2FtZTogaW5pdCxcclxuICAgIHJlc2V0R2FtZTogcmVzZXRcclxufTsiLCJjb25zdCBpbml0R2FtZSA9IHJlcXVpcmUoJy4vZW5naW5lLmpzJykuaW5pdEdhbWUsXHJcbiAgICBjbG9zZU1vZGFsU3RhcnQgPSByZXF1aXJlKCcuL3N0YXJ0R2FtZS5qcycpLmNsb3NlTW9kYWxTdGFydCxcclxuICAgIGNob29zZVBsYXllciA9IHJlcXVpcmUoJy4vc3RhcnRHYW1lLmpzJykuY2hvb3NlUGxheWVyLFxyXG4gICAgcGxheWVyID0gcmVxdWlyZSgnLi9hcHAuanMnKS5wbGF5ZXIsXHJcbiAgICBpbml0ID0gcmVxdWlyZSgnLi9lbmdpbmUuanMnKTtcclxuXHJcbnZhciBzdGFydFBsYXlCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcubW9kYWxTdGFydF9fYnV0dG9uJylbMF07XHJcbmNob29zZVBsYXllckVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnI21vZGFsUGxheWVycycpWzBdO1xyXG5cclxuXHJcbi8vIFRoaXMgbGlzdG5lciBmb3IgY2hvb3NpbmcgcGxheWVyIGJvZHkuIEl0IHNldHMgY2hvb3NlbiBpbWFnZSBcclxuLy8gZm9yIHBsYXllciBhbmQgc2V0IHBsYXllciBwcm9wZXJ0eSBwbGF5ZXJBY3RpdmUgdG8gdHJ1ZS5cclxuY2hvb3NlUGxheWVyRWwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbihlKSB7XHJcbiAgICBjaG9vc2VQbGF5ZXIoZSk7XHJcbiAgICBwbGF5ZXIuYWN0aXZlUGxheWVyKCk7XHJcbn0pO1xyXG5cclxuLy8gVGhpcyBsaXN0ZW5zIGZvciBidXRvbiBzdGFydCBnYW1lXHJcbnN0YXJ0UGxheUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKGUpIHtcclxuICAgIGlmIChwbGF5ZXIuZ2V0UGxheWVyQWN0aXZpdHkoKSkge1xyXG4gICAgICAgIGNsb3NlTW9kYWxTdGFydCgpO1xyXG4gICAgICAgIGluaXRHYW1lKCk7XHJcbiAgICB9XHJcbn0pO1xyXG5cclxuLy8gVGhpcyBsaXN0ZW5zIGZvciBrZXkgcHJlc3NlcyBhbmQgc2VuZHMgdGhlIGtleXMgdG8geW91clxyXG4vLyBQbGF5ZXIuaGFuZGxlSW5wdXQoKSBtZXRob2QuIFlvdSBkb24ndCBuZWVkIHRvIG1vZGlmeSB0aGlzLlxyXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXl1cCcsIGZ1bmN0aW9uKGUpIHtcclxuICAgIHZhciBhbGxvd2VkS2V5cyA9IHtcclxuICAgICAgICAzNzogJ2xlZnQnLFxyXG4gICAgICAgIDM4OiAndXAnLFxyXG4gICAgICAgIDM5OiAncmlnaHQnLFxyXG4gICAgICAgIDQwOiAnZG93bidcclxuICAgIH07XHJcblxyXG4gICAgcGxheWVyLmhhbmRsZUlucHV0KGFsbG93ZWRLZXlzW2Uua2V5Q29kZV0pO1xyXG59KTsiLCIvKiBSZXNvdXJjZXMuanNcclxuICogVGhpcyBpcyBzaW1wbHkgYW4gaW1hZ2UgbG9hZGluZyB1dGlsaXR5LiBJdCBlYXNlcyB0aGUgcHJvY2VzcyBvZiBsb2FkaW5nXHJcbiAqIGltYWdlIGZpbGVzIHNvIHRoYXQgdGhleSBjYW4gYmUgdXNlZCB3aXRoaW4geW91ciBnYW1lLiBJdCBhbHNvIGluY2x1ZGVzXHJcbiAqIGEgc2ltcGxlIFwiY2FjaGluZ1wiIGxheWVyIHNvIGl0IHdpbGwgcmV1c2UgY2FjaGVkIGltYWdlcyBpZiB5b3UgYXR0ZW1wdFxyXG4gKiB0byBsb2FkIHRoZSBzYW1lIGltYWdlIG11bHRpcGxlIHRpbWVzLlxyXG4gKi9cclxudmFyIFJlc291cmNlcyA9IChmdW5jdGlvbigpIHtcclxuICAgIHZhciByZXNvdXJjZUNhY2hlID0ge307XHJcbiAgICB2YXIgcmVhZHlDYWxsYmFja3MgPSBbXTtcclxuXHJcbiAgICAvKiBUaGlzIGlzIHRoZSBwdWJsaWNseSBhY2Nlc3NpYmxlIGltYWdlIGxvYWRpbmcgZnVuY3Rpb24uIEl0IGFjY2VwdHNcclxuICAgICAqIGFuIGFycmF5IG9mIHN0cmluZ3MgcG9pbnRpbmcgdG8gaW1hZ2UgZmlsZXMgb3IgYSBzdHJpbmcgZm9yIGEgc2luZ2xlXHJcbiAgICAgKiBpbWFnZS4gSXQgd2lsbCB0aGVuIGNhbGwgb3VyIHByaXZhdGUgaW1hZ2UgbG9hZGluZyBmdW5jdGlvbiBhY2NvcmRpbmdseS5cclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gbG9hZCh1cmxPckFycikge1xyXG4gICAgICAgIGlmKHVybE9yQXJyIGluc3RhbmNlb2YgQXJyYXkpIHtcclxuICAgICAgICAgICAgLyogSWYgdGhlIGRldmVsb3BlciBwYXNzZWQgaW4gYW4gYXJyYXkgb2YgaW1hZ2VzXHJcbiAgICAgICAgICAgICAqIGxvb3AgdGhyb3VnaCBlYWNoIHZhbHVlIGFuZCBjYWxsIG91ciBpbWFnZVxyXG4gICAgICAgICAgICAgKiBsb2FkZXIgb24gdGhhdCBpbWFnZSBmaWxlXHJcbiAgICAgICAgICAgICAqL1xyXG4gICAgICAgICAgICB1cmxPckFyci5mb3JFYWNoKGZ1bmN0aW9uKHVybCkge1xyXG4gICAgICAgICAgICAgICAgX2xvYWQodXJsKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgLyogVGhlIGRldmVsb3BlciBkaWQgbm90IHBhc3MgYW4gYXJyYXkgdG8gdGhpcyBmdW5jdGlvbixcclxuICAgICAgICAgICAgICogYXNzdW1lIHRoZSB2YWx1ZSBpcyBhIHN0cmluZyBhbmQgY2FsbCBvdXIgaW1hZ2UgbG9hZGVyXHJcbiAgICAgICAgICAgICAqIGRpcmVjdGx5LlxyXG4gICAgICAgICAgICAgKi9cclxuICAgICAgICAgICAgX2xvYWQodXJsT3JBcnIpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKiBUaGlzIGlzIG91ciBwcml2YXRlIGltYWdlIGxvYWRlciBmdW5jdGlvbiwgaXQgaXNcclxuICAgICAqIGNhbGxlZCBieSB0aGUgcHVibGljIGltYWdlIGxvYWRlciBmdW5jdGlvbi5cclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gX2xvYWQodXJsKSB7XHJcbiAgICAgICAgaWYocmVzb3VyY2VDYWNoZVt1cmxdKSB7XHJcbiAgICAgICAgICAgIC8qIElmIHRoaXMgVVJMIGhhcyBiZWVuIHByZXZpb3VzbHkgbG9hZGVkIGl0IHdpbGwgZXhpc3Qgd2l0aGluXHJcbiAgICAgICAgICAgICAqIG91ciByZXNvdXJjZUNhY2hlIGFycmF5LiBKdXN0IHJldHVybiB0aGF0IGltYWdlIHJhdGhlciB0aGFuXHJcbiAgICAgICAgICAgICAqIHJlLWxvYWRpbmcgdGhlIGltYWdlLlxyXG4gICAgICAgICAgICAgKi9cclxuICAgICAgICAgICAgcmV0dXJuIHJlc291cmNlQ2FjaGVbdXJsXTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAvKiBUaGlzIFVSTCBoYXMgbm90IGJlZW4gcHJldmlvdXNseSBsb2FkZWQgYW5kIGlzIG5vdCBwcmVzZW50XHJcbiAgICAgICAgICAgICAqIHdpdGhpbiBvdXIgY2FjaGU7IHdlJ2xsIG5lZWQgdG8gbG9hZCB0aGlzIGltYWdlLlxyXG4gICAgICAgICAgICAgKi9cclxuICAgICAgICAgICAgdmFyIGltZyA9IG5ldyBJbWFnZSgpO1xyXG4gICAgICAgICAgICBpbWcub25sb2FkID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAvKiBPbmNlIG91ciBpbWFnZSBoYXMgcHJvcGVybHkgbG9hZGVkLCBhZGQgaXQgdG8gb3VyIGNhY2hlXHJcbiAgICAgICAgICAgICAgICAgKiBzbyB0aGF0IHdlIGNhbiBzaW1wbHkgcmV0dXJuIHRoaXMgaW1hZ2UgaWYgdGhlIGRldmVsb3BlclxyXG4gICAgICAgICAgICAgICAgICogYXR0ZW1wdHMgdG8gbG9hZCB0aGlzIGZpbGUgaW4gdGhlIGZ1dHVyZS5cclxuICAgICAgICAgICAgICAgICAqL1xyXG4gICAgICAgICAgICAgICAgcmVzb3VyY2VDYWNoZVt1cmxdID0gaW1nO1xyXG5cclxuICAgICAgICAgICAgICAgIC8qIE9uY2UgdGhlIGltYWdlIGlzIGFjdHVhbGx5IGxvYWRlZCBhbmQgcHJvcGVybHkgY2FjaGVkLFxyXG4gICAgICAgICAgICAgICAgICogY2FsbCBhbGwgb2YgdGhlIG9uUmVhZHkoKSBjYWxsYmFja3Mgd2UgaGF2ZSBkZWZpbmVkLlxyXG4gICAgICAgICAgICAgICAgICovXHJcbiAgICAgICAgICAgICAgICBpZihpc1JlYWR5KCkpIHtcclxuICAgICAgICAgICAgICAgICAgICByZWFkeUNhbGxiYWNrcy5mb3JFYWNoKGZ1bmN0aW9uKGZ1bmMpIHsgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmMuY2FsbCgpOyBcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIC8qIFNldCB0aGUgaW5pdGlhbCBjYWNoZSB2YWx1ZSB0byBmYWxzZSwgdGhpcyB3aWxsIGNoYW5nZSB3aGVuXHJcbiAgICAgICAgICAgICAqIHRoZSBpbWFnZSdzIG9ubG9hZCBldmVudCBoYW5kbGVyIGlzIGNhbGxlZC4gRmluYWxseSwgcG9pbnRcclxuICAgICAgICAgICAgICogdGhlIGltYWdlJ3Mgc3JjIGF0dHJpYnV0ZSB0byB0aGUgcGFzc2VkIGluIFVSTC5cclxuICAgICAgICAgICAgICovXHJcbiAgICAgICAgICAgIHJlc291cmNlQ2FjaGVbdXJsXSA9IGZhbHNlO1xyXG4gICAgICAgICAgICBpbWcuc3JjID0gdXJsO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKiBUaGlzIGlzIHVzZWQgYnkgZGV2ZWxvcGVycyB0byBncmFiIHJlZmVyZW5jZXMgdG8gaW1hZ2VzIHRoZXkga25vd1xyXG4gICAgICogaGF2ZSBiZWVuIHByZXZpb3VzbHkgbG9hZGVkLiBJZiBhbiBpbWFnZSBpcyBjYWNoZWQsIHRoaXMgZnVuY3Rpb25zXHJcbiAgICAgKiB0aGUgc2FtZSBhcyBjYWxsaW5nIGxvYWQoKSBvbiB0aGF0IFVSTC5cclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gZ2V0KHVybCkge1xyXG4gICAgICAgIHJldHVybiByZXNvdXJjZUNhY2hlW3VybF07XHJcbiAgICB9XHJcblxyXG4gICAgLyogVGhpcyBmdW5jdGlvbiBkZXRlcm1pbmVzIGlmIGFsbCBvZiB0aGUgaW1hZ2VzIHRoYXQgaGF2ZSBiZWVuIHJlcXVlc3RlZFxyXG4gICAgICogZm9yIGxvYWRpbmcgaGF2ZSBpbiBmYWN0IGJlZW4gcHJvcGVybHkgbG9hZGVkLlxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBpc1JlYWR5KCkge1xyXG4gICAgICAgIHZhciByZWFkeSA9IHRydWU7XHJcbiAgICAgICAgZm9yKHZhciBrIGluIHJlc291cmNlQ2FjaGUpIHtcclxuICAgICAgICAgICAgaWYocmVzb3VyY2VDYWNoZS5oYXNPd25Qcm9wZXJ0eShrKSAmJlxyXG4gICAgICAgICAgICAgICAhcmVzb3VyY2VDYWNoZVtrXSkge1xyXG4gICAgICAgICAgICAgICAgcmVhZHkgPSBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcmVhZHk7XHJcbiAgICB9XHJcblxyXG4gICAgLyogVGhpcyBmdW5jdGlvbiB3aWxsIGFkZCBhIGZ1bmN0aW9uIHRvIHRoZSBjYWxsYmFjayBzdGFjayB0aGF0IGlzIGNhbGxlZFxyXG4gICAgICogd2hlbiBhbGwgcmVxdWVzdGVkIGltYWdlcyBhcmUgcHJvcGVybHkgbG9hZGVkLlxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBvblJlYWR5KGZ1bmMpIHtcclxuICAgICAgICByZWFkeUNhbGxiYWNrcy5wdXNoKGZ1bmMpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qIFRoaXMgb2JqZWN0IGRlZmluZXMgdGhlIHB1YmxpY2x5IGFjY2Vzc2libGUgZnVuY3Rpb25zIGF2YWlsYWJsZSB0b1xyXG4gICAgICogZGV2ZWxvcGVycyBieSBjcmVhdGluZyBhIGdsb2JhbCBSZXNvdXJjZXMgb2JqZWN0LlxyXG4gICAgICovXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIGxvYWQ6IGxvYWQsXHJcbiAgICAgICAgZ2V0OiBnZXQsXHJcbiAgICAgICAgb25SZWFkeTogb25SZWFkeSxcclxuICAgICAgICBpc1JlYWR5OiBpc1JlYWR5XHJcbiAgICB9O1xyXG59KSgpO1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBSZXNvdXJjZXM7XHJcbiIsImNvbnN0IFJlc291cmNlcyA9IHJlcXVpcmUoJy4vcmVzb3VyY2VzLmpzJyksXHJcbiAgICB1dGlscyA9IHJlcXVpcmUoJy4vdXRpbHMvdXRpbHMuanMnKSxcclxuICAgIHBsYXllciA9IHJlcXVpcmUoJy4vYXBwLmpzJykucGxheWVyO1xyXG5cclxudmFyIGFsbFBsYXllcnMgPSBbXHJcbiAgICAgICAgLy8gUGxheWVyIHNvdXJjZXNcclxuICAgICAgICAnaW1hZ2VzL2NoYXItYm95LnBuZycsXHJcbiAgICAgICAgJ2ltYWdlcy9jaGFyLWNhdC1naXJsLnBuZycsXHJcbiAgICAgICAgJ2ltYWdlcy9jaGFyLWhvcm4tZ2lybC5wbmcnLFxyXG4gICAgICAgICdpbWFnZXMvY2hhci1waW5rLWdpcmwucG5nJyxcclxuICAgICAgICAnaW1hZ2VzL2NoYXItcHJpbmNlc3MtZ2lybC5wbmcnXHJcbiAgICBdLFxyXG4gICAgYWxsS2V5c0ZvclBsYXllcnMgPSBbXHJcbiAgICAgICAgJ0JveScsXHJcbiAgICAgICAgJ0NhdCcsXHJcbiAgICAgICAgJ0hvcm4nLFxyXG4gICAgICAgICdQaW5rJyxcclxuICAgICAgICAnUHJpbmNlc3MnXHJcbiAgICBdLFxyXG4gICAgbW9kYWxXaW5kb3cgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcubW9kYWxTdGFydCcpWzBdO1xyXG5cclxuZnVuY3Rpb24gYWRkUGxheWVyc1RvTW9kYWxTdGFydCgpIHtcclxuICAgIHZhciBtb2RhbFBsYXllcnMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbW9kYWxQbGF5ZXJzJyksXHJcbiAgICAgICAgcGxheWVyQ29udGFpbmVyLCBwbGF5ZXIsIGksIGosIGxlbiwgbGVuSjtcclxuXHJcbiAgICBmb3IgKGkgPSAwLCBsZW4gPSBhbGxQbGF5ZXJzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XHJcbiAgICAgICAgcGxheWVyID0gUmVzb3VyY2VzLmdldChhbGxQbGF5ZXJzW2ldKTtcclxuICAgICAgICBwbGF5ZXJDb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgICBwbGF5ZXJDb250YWluZXJUZXh0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpO1xyXG4gICAgICAgIHBsYXllckNvbnRhaW5lci5jbGFzc05hbWUgPSAncGxheWVyQ29udGFpbmVyJztcclxuXHJcbiAgICAgICAgZm9yIChqID0gMCwgbGVuSiA9IGFsbEtleXNGb3JQbGF5ZXJzLmxlbmd0aDsgaiA8IGxlbko7IGorKykge1xyXG4gICAgICAgICAgICBpZiAoYWxsUGxheWVyc1tpXS5pbmRleE9mKGFsbEtleXNGb3JQbGF5ZXJzW2pdLnRvTG93ZXJDYXNlKCkpID4gLTEpIHtcclxuICAgICAgICAgICAgICAgIHBsYXllci5kYXRhc2V0LmJvZHlUeXBlID0gYWxsS2V5c0ZvclBsYXllcnNbal07XHJcbiAgICAgICAgICAgICAgICBwbGF5ZXJDb250YWluZXJUZXh0LnRleHRDb250ZW50ID0gYWxsS2V5c0ZvclBsYXllcnNbal07XHJcbiAgICAgICAgICAgICAgICBwbGF5ZXJDb250YWluZXIuYXBwZW5kQ2hpbGQocGxheWVyKTtcclxuICAgICAgICAgICAgICAgIHBsYXllckNvbnRhaW5lci5hcHBlbmRDaGlsZChwbGF5ZXJDb250YWluZXJUZXh0KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgbW9kYWxQbGF5ZXJzLmFwcGVuZENoaWxkKHBsYXllckNvbnRhaW5lcik7XHJcbiAgICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGNob29zZVBsYXllcihlKSB7XHJcbiAgICB2YXIgcGxheWVyRGF0YSA9IGUudGFyZ2V0LmRhdGFzZXQsXHJcbiAgICAgICAgaSwgbGVuO1xyXG5cclxuICAgIGNvbnNvbGUubG9nKHBsYXllckRhdGEpO1xyXG5cclxuICAgIGZvciAoaSA9IDAsIGxlbiA9IGFsbFBsYXllcnMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcclxuICAgICAgICBpZiAoYWxsUGxheWVyc1tpXS5pbmRleE9mKHBsYXllckRhdGEuYm9keVR5cGUudG9Mb3dlckNhc2UoKSkgPiAtMSkge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhSZXNvdXJjZXMuZ2V0KGFsbFBsYXllcnNbaV0pKTtcclxuICAgICAgICAgICAgcGxheWVyLnNldFBsYXllcihSZXNvdXJjZXMuZ2V0KGFsbFBsYXllcnNbaV0pKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG59XHJcblxyXG5mdW5jdGlvbiBjbG9zZU1vZGFsU3RhcnQoKSB7XHJcbiAgICB1dGlscy50b2dnbGVDbGFzcyhtb2RhbFdpbmRvdywgJ2FjdGl2ZScpO1xyXG59XHJcblxyXG5cclxuXHJcbi8vIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oZSkge1xyXG4vLyB9KTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0ge1xyXG4gICAgYWRkUGxheWVyc1RvTW9kYWxTdGFydDogYWRkUGxheWVyc1RvTW9kYWxTdGFydCxcclxuICAgIGNsb3NlTW9kYWxTdGFydDogY2xvc2VNb2RhbFN0YXJ0LFxyXG4gICAgY2hvb3NlUGxheWVyOiBjaG9vc2VQbGF5ZXJcclxufTsiLCIvKipcclxuICogQGRlc2NyaXB0aW9uIFRvZ2dsZSBnaXZlbiBjbGFzcyB1c2luZyBjcm9zcyBicm93c2VyIHByb3BlcnR5IENsYXNzTmFtZS5cclxuICogQHBhcmFtIHtPYmplY3R9IGVsZW1lbnQgRE9NRWxlbWVudCB0byB0b2dnbGUgY2xhc3MuXHJcbiAqIEBwYXJhbSB7U3RyaW5nfSBjbGFzc05hbWUgQ2xhc3MgbmFtZSB0aGF0IHNob3VsZCBiZSB0b2dnbGVkLlxyXG4gKi9cclxuLy8gdG9nZ2xlQ2xhc3MgZnVuY3Rpb24gZnJvbSBodHRwczovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy8xODg4MDg5MC9ob3ctZG8taS10b2dnbGUtYW4tZWxlbWVudHMtY2xhc3MtaW4tcHVyZS1qYXZhc2NyaXB0XHJcbmZ1bmN0aW9uIHRvZ2dsZUNsYXNzKGVsZW1lbnQsIGNsYXNzTmFtZSkge1xyXG4gICAgaWYgKCFlbGVtZW50IHx8ICFjbGFzc05hbWUpIHtcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgdmFyIGNsYXNzU3RyaW5nID0gZWxlbWVudC5jbGFzc05hbWUsXHJcbiAgICAgICAgbmFtZUluZGV4ID0gY2xhc3NTdHJpbmcuaW5kZXhPZihjbGFzc05hbWUpO1xyXG4gICAgaWYgKG5hbWVJbmRleCA9PSAtMSkge1xyXG4gICAgICAgIGNsYXNzU3RyaW5nICs9ICcgJyArIGNsYXNzTmFtZTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgY2xhc3NTdHJpbmcgPSBjbGFzc1N0cmluZy5zdWJzdHIoMCwgbmFtZUluZGV4KSArIGNsYXNzU3RyaW5nLnN1YnN0cihuYW1lSW5kZXggKyBjbGFzc05hbWUubGVuZ3RoKTtcclxuICAgIH1cclxuICAgIGVsZW1lbnQuY2xhc3NOYW1lID0gY2xhc3NTdHJpbmc7XHJcbn1cclxuXHJcbm1vZHVsZS5leHBvcnRzID0ge1xyXG4gICAgdG9nZ2xlQ2xhc3M6IHRvZ2dsZUNsYXNzXHJcbn07Il19\n"]}